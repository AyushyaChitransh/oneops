#\<% load "<circuit_root>/components/kitchen-integration/monkey_patch.rb" %>
#\<% ruby_path = '$(cat /opt/oneops/ruby_bindir || dirname $(which ruby) )' %>
---
<if(local)>
driver:
  name: proxy
  host: 127.0.0.1
  reset_command: "exit 0"
  transport: local
provisioner:
  name: dummy
verifier:
  name: serverspec
  remote_exec: false
  transport: local
  test_serverspec_installed: false
  additional_install_command: "mkdir -p <inductor_home>/test/gems"
  bundler_path: 'GEM_HOME=<inductor_home>/test/gems /usr/local/bin'
  gemfile: test/integration/Gemfile
  env_vars:
    GEM_PATH: <inductor_home>/test/gems:/usr/local/share/gems
platforms:
  - name: <platform_name>
suites:
  - name: <recipe_name>
    verifier:
      patterns:
      - test/integration/<recipe_name>/serverspec/*_spec.rb

<else>
driver:
  name: proxy
  host: <driver_host>
  reset_command: "exit 0"
  port: 22
  username: <user>
  ssh_key: <ssh_key>
provisioner:
  name: shell
  script: <circuit_root>/components/kitchen-integration/bootstrap.sh
  root_path: <verifier_root_path>
  data_path: ./test/integration
transport:
  name: rsync
  ssh_key: <ssh_key>
  username: <user>
verifier:
  name: serverspec
  custom_install_command: <custom_install>
  custom_serverspec_command: <custom_serverspec>

platforms:
  - name: <platform_name>
suites:
  - name: <recipe_name>
<endif>
